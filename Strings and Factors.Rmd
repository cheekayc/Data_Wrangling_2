---
title: "Strings and Factors"
author: "Lectured by Jeff Goldsmith"
date: "2022-10-18"
output: github_document
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(message = FALSE)

library(tidyverse)
library(rvest)
library(p8105.datasets)
```

# Strings and regex

You can use `str_detect` to find cases where the match exists (often useful in conjunction with `filter`), 
and you can use `str_replace` to replace an instance of a match with something else (often useful in conjunction with `mutate`). 

In the following examples we’ll mostly focus on vectors to avoid the complication of data frames, but we’ll see those shortly.

```{r EX1}
# Let us define a collection of string vectors, they will be presented in dataframe:
string_vec = c("my", "name", "is", "jeff")

# Detect this pattern "jeff" in the string_vec:
str_detect(string_vec, "jeff")

# Detect "a" in the string_vec:
str_detect(string_vec, "a")
# "a" is only appeared in the second string "name".

# Detect "m":
str_detect(string_vec, "m")
# "m" is appeared in the first two strings "my" & "name".
```

```{r EX2}
# Replace the string "jeff" with "Jeff":
str_replace(string_vec, "jeff", "Jeff")

# Replace lowercase "m" with uppercase "M":
str_replace(string_vec, "m", "M")
```

For exact matches, we can designate matches at the beginning or end of a line.
```{r match strings}
string_vec2 = c(
  "i think we all rule for participating",
  "i think i have been caught",
  "i think this will be quite fun actually",
  "it will be fun, i think")

str_detect(string_vec2, "i think")
# It will return "TRUE" for all because "i think" appears in all four strings.

# Detect something that starts with "i think":
str_detect(string_vec2, "^i think")

# Detect something that ends with "i think":
str_detect(string_vec2, "i think$")
```

In the following example, we see "Bush" in different forms (upper/lowercase, standalone word or connected with other words). We can still detect all of them:
```{r EX3}
string_vec3 = c(
  "Y'all remember Pres. HW Bush?",
  "I saw a green bush",
  "BBQ and Bushwalking at Molonglo Gorge",
  "BUSH -- LIVE IN CONCERT!!")

str_detect(string_vec3,"[Bb]ush")
# The all uppercase BUSH is not detected.

# This will allow me to detect all forms of "bush".
str_detect(string_vec3, "[Bb][Uu][Ss][Hh]")

```

Which of these following vectors have numbers followed by letters?
```{r EX4}
string_vec4 = c(
  '7th inning stretch',
  '1st half soon to begin. Texas won the toss.',
  'she is 5 feet 4 inches tall',
  '3AM - cant sleep :(')

# Detect anything that has a number from 0 to 9, followed by a letter from capital A to Z:
str_detect(string_vec4, "[0-9][A-Z]")

# Detect anything that has a number from 0 to 9, followed by a letter from lowercase a to z or capital A to Z:
str_detect(string_vec4, "[0-9][a-zA-Z]")
```

The character `.` matches anything.
```{r EX5}
string_vec5 = c(
  'Its 7:11 in the evening',
  'want to go to 7-11?',
  'my flight is AA711',
  'NetBios: scanning ip 203.167.114.66')

str_detect(string_vec5, "7.11")
# The third string wasn't detected because there isn't anything between 7 & 11.
```

What if I want to search for something exactly like numbers in the []? Some characters are “special”. These include `[` and `]`, `(` and `)`, and `.`. 
If we want to search for these, we have to indicate they’re special using `\`. Unfortunately, `\` is also special, so things get weird.
```{r EX6}
string_vec6 = c(
  'The CI is [2, 5]',
  ':-]',
  ':-[',
  'I found the answer on pages [6-7]')

str_detect(string_vec6, "[")
# This is not going to work because R thinks you forgot to close the bracket.

# If we want to look for exactly this "[]" in the strings, we need a "\" to indicate the bracket is special. 
# But because the "\" is also a special character, we need two "\" to make this work:
str_detect(string_vec6, "\\[")

# Detect something that has a bracket "[" followed by a range of numbers 0 to 9:
str_detect(string_vec6, "\\[[0-9]")
```









